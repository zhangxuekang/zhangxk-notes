<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/styles/default.min.css"
    />
    <link rel="stylesheet" href="src/index.css" />
    <title>${title}</title>
    <style>
      html,
      body,
      ul,
      li,
      ol,
      dl,
      dd,
      dt,
      p,
      h1,
      h2,
      h3,
      h4,
      h5,
      h6,
      form,
      fieldset,
      legend,
      img {
        margin: 0;
        padding: 0;
      }

      body {
        width: 60%;
        margin-left: 20%;
      }
    </style>
  </head>
  <body>
    <h1 id="移动端页面元素尺寸解决方案之一">移动端页面元素尺寸解决方案之一</h1>
<p>如果html5要适应各种分辨率的移动设备,应该使用rem这样的尺寸单位.主流做法基本也都是这样做的.但是,如果html5页面是在webview中打开的,并且webview不是通常的手机视窗尺寸,而是占了部分页面,使用rem单位的转化标准就没有了通用性.面对这种情况,可以尝试以下的解决方案.
<img alt="非全屏的webview" src="https://zhangxuekang.github.io/src/blog/mobile-size-set/mobile-size.png" width="60%"></p>
<h2 id="使用transform的scale来适配所有尺寸的view">使用transform的scale来适配所有尺寸的view</h2>
<p>设计稿的尺寸一般是px,那么写页面的时候,就使用px单位,大小和设计稿保持一致就好.内容区域的最外层使用scale缩放,缩放的比例根据内容区原始的尺寸与渲染区域(如果是webview中就是webview的大小,如果是浏览器中就是浏览器视窗的大小)的比例来决定的.</p>
<p>举个例子,写个demo:</p>
<pre><code class="language-html"><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;main&quot;</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span>
</code></pre>
<p>class为main的dev是内容区域,内部可以随意添加布置元素.想达到的效果是main元素随着窗口等比例放大缩小,宽最大不超过视窗的宽,高最大不超过视窗的高.
main元素关键样式:</p>
<pre><code class="language-css"> <span class="hljs-comment">/* 宽高根据设计稿来就行,不必须是正方形区域 */</span>
<span class="hljs-selector-class">.main</span> {
  <span class="hljs-attribute">position</span>: absolute;
  <span class="hljs-attribute">width</span>: <span class="hljs-number">720px</span>;
  <span class="hljs-attribute">height</span>: <span class="hljs-number">720px</span>;
  <span class="hljs-attribute">left</span>: <span class="hljs-number">50%</span>;
  <span class="hljs-attribute">top</span>: <span class="hljs-number">50%</span>;
  <span class="hljs-attribute">transform</span>: <span class="hljs-built_in">translateX</span>(-<span class="hljs-number">50%</span>) <span class="hljs-built_in">translateY</span>(-<span class="hljs-number">50%</span>);
  <span class="hljs-attribute">transform-origin</span>: center center;
}
</code></pre>
<p>页面加载好后,监听视窗尺寸的变化,修改main元素的transform属性:</p>
<pre><code class="language-js"><span class="hljs-variable language_">window</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">&#x27;resize&#x27;</span>, updateSize)
<span class="hljs-variable language_">window</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">&#x27;load&#x27;</span>, updateSize)
<span class="hljs-keyword">function</span> <span class="hljs-title function_">updateSize</span>(<span class="hljs-params"></span>) {
  <span class="hljs-comment">// 获取视窗尺寸</span>
  <span class="hljs-keyword">const</span> bodyW = <span class="hljs-variable language_">document</span>.<span class="hljs-property">documentElement</span>.<span class="hljs-property">clientWidth</span>;
  <span class="hljs-keyword">const</span> bodyH = <span class="hljs-variable language_">document</span>.<span class="hljs-property">documentElement</span>.<span class="hljs-property">clientHeight</span>;
  <span class="hljs-comment">// 计算比例,用视窗尺寸与内容的实际尺寸相除</span>
  <span class="hljs-keyword">const</span> wScale = bodyW / <span class="hljs-number">720</span>;
  <span class="hljs-keyword">const</span> hScale = bodyH / <span class="hljs-number">720</span>;
  <span class="hljs-keyword">const</span> scale = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">min</span>(wScale, hScale);
  <span class="hljs-keyword">const</span> $main = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">&#x27;.main&#x27;</span>);
  $main.<span class="hljs-property">style</span>.<span class="hljs-property">transform</span> = <span class="hljs-string">`translateX(-50%) translateY(-50%) scale(<span class="hljs-subst">${scale}</span>)`</span>;
}
</code></pre>
<p><a href="https://zhangxuekang.github.io/src/blog/mobile-size-set/hedgehog.html">点击这里看demo,修改浏览器视窗大小看效果</a></p>

  </body>
</html>
